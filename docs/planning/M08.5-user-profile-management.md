# Milestone 8.5: User Profile Management

**Status**: ✅ Completed (2026-02-17)

**Goal**: Verified users can update their profile information with re-verification flow.

**Implementation Notes**:
- Email change is intentionally disabled in the profile edit form. Since email is the authentication identifier (used for magic links), changing it requires a more complex flow. Email changes should be handled by an administrator. This is noted in the UI with an explanatory message.
- All other fields (firstName, lastName, phone, unitNumber, resident/owner status) can be edited and trigger re-verification when changed.

**Features**:
- User profile page showing: first Name, lastName, email, phone, unitNumber, isResident, isOwner
- Profile edit form
- Changes to firstName, lastName, unitNumber, phone, or resident/owner status trigger re-verification:
  - User's verificationStatus reverts to "pending"
  - User is notified of re-verification requirement
  - **Option to cancel changes** and maintain verified status
  - Confirmation dialog before saving changes that require re-verification
- Email change requires email confirmation before taking effect
- After profile changes requiring re-verification:
  - User reverts to pending status (cannot access protected content)
  - Verifiers notified of profile update for re-verification
  - Email sent to user (EmailTemplate: "profile-update-reverify")
- Audit log for profile updates
- E2E test for profile update flow

**Manual Tests**:
1. Log in as verified user
2. Navigate to profile page
3. Change firstName - submit form
4. Verify warning appears: "This change requires re-verification"
5. Confirm you want to proceed
6. Verify verificationStatus changed to "pending"
7. Verify verifiers receive email notification
8. Verify user receives "profile-update-reverify" email
9. User can no longer access protected content
10. Log in as verifier, approve the profile change
11. User can access protected content again
12. **Test cancel option**:
    - Go to profile, change unitNumber
    - See re-verification warning
    - Click cancel - changes not saved, still verified
13. Verify audit log records profile update

**Automated Tests**:
- Profile update API works
- Changes requiring re-verification properly revert status to pending
- Verifiers notified of profile updates
- User receives re-verification email
- Cancel option works correctly
- Audit log records profile changes
- E2E test: update profile → re-verify → access restored
